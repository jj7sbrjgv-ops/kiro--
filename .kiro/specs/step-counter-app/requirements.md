# 要件定義書

## はじめに

本ドキュメントは、スマートフォン向けの歩数計アプリケーションの要件を定義します。このアプリケーションは、HTML、CSS、JavaScriptを使用して実装され、ユーザーの歩数をカウントし、24時間ごとに自動的にリセットする機能を提供します。

## 用語集

- **System（システム）**: 歩数計アプリケーション全体
- **Step_Counter（歩数カウンター）**: 歩数を計測・記録するコンポーネント
- **Storage_Manager（ストレージマネージャー）**: データの保存と読み込みを管理するコンポーネント
- **Reset_Timer（リセットタイマー）**: 24時間周期でのリセットを管理するコンポーネント
- **User（ユーザー）**: アプリケーションを使用する人
- **Step（歩数）**: 検出された歩行の回数
- **Reset_Time（リセット時刻）**: 歩数カウンターがリセットされる時刻
- **Daily_Period（日次期間）**: リセット時刻から次のリセット時刻までの24時間

## 要件

### 要件1: 歩数の計測

**ユーザーストーリー:** ユーザーとして、スマートフォンで歩数を自動的にカウントしてほしい。そうすることで、日々の運動量を把握できる。

#### 受入基準

1. WHEN デバイスの加速度センサーが動きを検出した場合、THE Step_Counter SHALL その動きを分析して歩数としてカウントする
2. WHEN 歩数が増加した場合、THE System SHALL 更新された歩数を即座に画面に表示する
3. THE Step_Counter SHALL 加速度センサーのデータにアクセスする権限を要求する
4. IF センサーへのアクセスが拒否された場合、THEN THE System SHALL エラーメッセージを表示し、手動カウント機能を提供する

### 要件2: 歩数データの保存

**ユーザーストーリー:** ユーザーとして、アプリを閉じても歩数データが保持されてほしい。そうすることで、いつでも今日の歩数を確認できる。

#### 受入基準

1. WHEN 歩数が更新された場合、THE Storage_Manager SHALL その歩数をローカルストレージに即座に保存する
2. WHEN アプリが起動した場合、THE System SHALL ローカルストレージから現在の日次期間の歩数データを読み込む
3. THE Storage_Manager SHALL 歩数データと最終更新時刻を共に保存する
4. THE Storage_Manager SHALL リセット時刻の設定をローカルストレージに保存する

### 要件3: 24時間ごとの自動リセット

**ユーザーストーリー:** ユーザーとして、歩数が24時間ごとに自動的にリセットされてほしい。そうすることで、毎日新しい目標に向かって歩ける。

#### 受入基準

1. WHEN 現在時刻がリセット時刻に到達した場合、THE Reset_Timer SHALL 歩数カウンターを0にリセットする
2. WHEN リセットが実行された場合、THE System SHALL 前日の歩数データを履歴として保存する
3. WHEN リセットが実行された場合、THE System SHALL 次のリセット時刻を24時間後に設定する
4. WHILE アプリが起動していない間にリセット時刻を過ぎた場合、THE System SHALL 次回起動時にリセットを実行する

### 要件4: リセット時刻のカスタマイズ

**ユーザーストーリー:** ユーザーとして、24時間のスタート時刻を自分で設定したい。そうすることで、自分の生活リズムに合わせて歩数を管理できる。

#### 受入基準

1. THE System SHALL リセット時刻を設定するためのユーザーインターフェースを提供する
2. WHEN ユーザーがリセット時刻を変更した場合、THE System SHALL 新しいリセット時刻を検証し、有効な時刻形式であることを確認する
3. WHEN 有効なリセット時刻が設定された場合、THE Storage_Manager SHALL その設定を永続化する
4. WHEN リセット時刻が変更された場合、THE Reset_Timer SHALL 次のリセット予定時刻を再計算する

### 要件5: ユーザーインターフェース

**ユーザーストーリー:** ユーザーとして、現在の歩数と設定を見やすく表示してほしい。そうすることで、簡単に情報を確認できる。

#### 受入基準

1. THE System SHALL 現在の歩数を大きく見やすいフォントで表示する
2. THE System SHALL 次のリセット予定時刻を表示する
3. THE System SHALL リセット時刻を変更するための設定画面を提供する
4. WHEN 画面が表示されている場合、THE System SHALL 歩数の更新をリアルタイムで反映する
5. THE System SHALL スマートフォンの画面サイズに適応したレスポンシブデザインを提供する

### 要件6: データの整合性

**ユーザーストーリー:** システム管理者として、データの整合性が保たれることを確認したい。そうすることで、ユーザーに正確な情報を提供できる。

#### 受入基準

1. THE System SHALL 歩数が負の値にならないことを保証する
2. WHEN データの読み込みに失敗した場合、THE System SHALL デフォルト値（0歩）で初期化する
3. THE System SHALL 保存されたデータのタイムスタンプを検証し、データの新鮮性を確認する
4. IF 保存されたデータが現在の日次期間外のものである場合、THEN THE System SHALL 新しい日次期間として初期化する

### 要件7: エラーハンドリング

**ユーザーストーリー:** ユーザーとして、エラーが発生した場合でもアプリが使用可能であってほしい。そうすることで、中断されることなく歩数を記録できる。

#### 受入基準

1. IF 加速度センサーが利用できない場合、THEN THE System SHALL 手動カウント機能を提供する
2. IF ローカルストレージへのアクセスが失敗した場合、THEN THE System SHALL エラーメッセージを表示し、メモリ内でデータを保持する
3. WHEN エラーが発生した場合、THE System SHALL ユーザーに分かりやすいエラーメッセージを表示する
4. THE System SHALL エラー発生時でも基本的な歩数カウント機能を維持する
